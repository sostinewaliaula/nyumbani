"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6842,9689],{29689:function(e,r,n){n.r(r);var t=n(85893),a=n(67294),i=n(68387),s=n(45007);r.default=e=>{let{children:r,onNotificationReceived:n}=e,[o,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[f,g]=(0,a.useState)(!1),[p,d]=(0,a.useState)(""),{fetchToken:v,onMessageListener:h}=(0,i.Z)(),m=(0,s.v9)(e=>{var r;return null===(r=e.WebSetting)||void 0===r?void 0:r.fcmToken}),w=async()=>{await v(g,d)};return(0,a.useEffect)(()=>{w()},[c]),(0,a.useEffect)(()=>{u(m)},[c]),(0,a.useEffect)(()=>{h().then(e=>{e&&e.data&&(l(e.data),n(e.data))}).catch(e=>{console.error("Error handling foreground notification:",e)})},[o,n]),(0,a.useEffect)(()=>{p&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then(e=>{console.info("Service Worker registration successful with scope: ",e.scope)}).catch(e=>{console.error("Service Worker registration failed: ",e)})},[p]),(0,t.jsx)(t.Fragment,{children:r})}},68387:function(e,r,n){var t=n(83977),a=n(20061),i=n(80770),s=n(2370),o=n(30836),l=n(87076);r.Z=()=>{let e={apiKey:"AIzaSyBrhgJn_7ykwGKFirRKfyf14K5Fff98XzA",authDomain:"nyumbani-5a923.firebaseapp.com",projectId:"nyumbani-5a923",storageBucket:"nyumbani-5a923.firebasestorage.app",messagingSenderId:"263172140633",appId:"1:263172140633:web:1c941f9ed5426656784b48",measurementId:"G-KEXD1025GK"};i.Z.apps.length||i.Z.initializeApp(e);let r=(0,t.ZF)(e),n=(0,s.v0)(r),c=(0,t.C6)().length?(0,t.Mq)():(0,t.ZF)(e),u=async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return console.info("Service Worker registered:",e.scope),e}catch(e){console.error("Service Worker registration failed:",e)}return null},f=async()=>{try{if(await (0,a.Gb)())return(0,a.KL)(c);return console.error("Firebase messaging is not supported in this browser"),(0,l.e8)(),null}catch(e){return console.error("Error checking messaging support:",e),null}};return{firebaseApp:c,authentication:n,fetchToken:async(e,r)=>{try{await u();let n=await f();if(!n){console.error("Messaging not supported in this browser"),null==e||e(!1),null==r||r(null);return}let t=await Notification.requestPermission();if("granted"!==t){console.error("Notification permission denied"),null==e||e(!1),null==r||r(null);return}let i=await (0,a.LP)(n,{vapidKey:"BIPmj4vrUKc00ar524TMUKDAJ5IzlbLDa7mSKaKpnvUdv2zGs6QEDyy5g2XsPz28lA_FlBAfefma3_cyP0nzuwY"});i?(null==r||r(i),(0,o.Cw)(i),null==e||e(!0)):(console.error("No token available"),null==e||e(!1),null==r||r(null))}catch(n){console.error("Error fetching token:",n),null==e||e(!1),null==r||r(null)}},onMessageListener:async()=>{let e=await f();return e?new Promise(r=>{(0,a.ps)(e,e=>{r(e)})}):(console.error("Messaging not supported."),null)},signOut:()=>n.signOut()}}}}]);